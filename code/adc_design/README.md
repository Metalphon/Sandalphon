# PCF8591 + LCD1602 电压表设计

## 项目概述

本项目实现了一个基于FPGA的电压表系统，用于测量和显示外部输入电压。系统主要由三个模块组成：

1. IIC控制模块 - 通过IIC总线与PCF8591 ADC芯片通信，获取数字量模拟转换结果
2. 电压转换模块 - 将数字量转换为可读的电压值
3. LCD1602显示模块 - 显示当前电压值

## 系统架构

系统由以下主要文件组成：

- `main.v` - 顶层模块，集成所有子模块
- `iic_pcf8591.v` - IIC通信控制模块，与PCF8591 ADC芯片通信
- `voltage_convert.v` - 数字量转换模块，将ADC读取的数字值转换为电压值
- `lcd1602_display.v` - LCD1602显示控制模块，显示电压值
- `tb_main.v` - 测试平台，用于仿真验证

## 硬件连接

### PCF8591连接

PCF8591是一个8位A/D和D/A转换器，通过IIC总线通信。连接方式如下：

- SCL - 连接到FPGA的SCL引脚
- SDA - 连接到FPGA的SDA引脚
- 输入通道0 - 连接到被测电压源
- VDD - 连接到系统电源（通常为5V或3.3V）
- VSS - 连接到系统地

注意：SCL和SDA线需要连接上拉电阻（通常为4.7kΩ）。

### LCD1602连接

LCD1602是一个常用的字符LCD显示器，连接方式如下：

- RS - 寄存器选择信号，连接到FPGA的lcd_rs引脚
- RW - 读/写选择信号，连接到FPGA的lcd_rw引脚
- EN - 使能信号，连接到FPGA的lcd_en引脚
- D0-D7 - 数据总线，连接到FPGA的lcd_data[7:0]引脚
- VDD - 连接到系统电源（5V）
- VSS - 连接到系统地
- V0 - 对比度调节，通常通过电位器连接

## 使用说明

1. 使用FPGA开发工具（如Quartus、Vivado、ISE等）创建项目
2. 将所有源文件添加到项目中
3. 设置正确的引脚约束
4. 综合、布局布线并生成比特流文件
5. 下载比特流文件到FPGA开发板
6. 连接PCF8591和LCD1602模块
7. 连接电压源到PCF8591的输入通道0
8. 系统将在LCD1602上显示当前电压读数

## 仿真测试

可以使用提供的`tb_main.v`进行功能仿真：

1. 加载所有源文件
2. 将`tb_main.v`设置为顶层模块
3. 运行仿真
4. 观察波形和监视窗口，检查电压值是否正确转换和显示

## 扩展功能

本系统可以扩展以支持以下功能：

1. 多通道电压测量 - 通过修改IIC模块，可以读取PCF8591的其他通道
2. 数据记录 - 添加存储模块，记录电压随时间的变化
3. 按键控制 - 添加按键接口，实现更多交互功能
4. 报警功能 - 设置电压阈值，当电压超过或低于阈值时发出报警

## 注意事项

- PCF8591的参考电压影响测量精度，请确保稳定的参考电压
- LCD1602的对比度需要通过外部电位器调节
- IIC通信速率设置为100kHz，可以根据需要调整
- 系统时钟频率为50MHz，如果使用不同频率的时钟，需要修改分频系数

## 项目参数

- 系统时钟：50MHz
- IIC时钟：100kHz
- LCD更新率：约10Hz
- ADC分辨率：8位（PCF8591）
- 电压显示范围：0V - 5V
- 电压显示精度：0.01V 